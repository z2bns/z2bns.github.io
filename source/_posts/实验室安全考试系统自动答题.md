---
title: å®éªŒå®¤å®‰å…¨è€ƒè¯•ç³»ç»Ÿè‡ªåŠ¨ç­”é¢˜
date: 2020-10-26 14:31:33
categories:
- è¯¾ç¨‹
tags:
- çˆ¬è™«
---

###### å‰è¨€

å­¦æ ¡è¦æ±‚åœ¨å®éªŒå®¤å®‰å…¨è€ƒè¯•ç³»ç»Ÿä¸Šå­¦ä¹ å®éªŒå®¤å®‰å…¨ç›¸å…³çš„çŸ¥è¯†ï¼Œç„¶åå®Œæˆä¸€ä¸ªè€ƒè¯•ã€‚æˆ‘å°±æƒ³ç€å€Ÿè¿™ä¸ªæœºä¼šæŠŠpython  seleniumè‡ªåŠ¨åŒ–æµ‹è¯•æ¨¡å—çš„çŸ¥è¯†å†å­¦ä¸€ä¸‹ä»¥å‰åªç¨å¾®ç”¨è¿‡é‚£ä¹ˆä¸€ä¸¤ä¸‹ï¼Œåæ­£å°±æ˜¯ä¹±æå˜›ï¼Œå­¦ä¹ è¿™ä¹ˆæ¯ç‡¥å½“ç„¶è¦è‡ªå·±æ‰¾ç‚¹ä¹å­äº†ã€‚å®Œæˆäº†ä¸€ä¸ªè‡ªåŠ¨ç­”é¢˜çš„ä¸€ä¸ªè„šæœ¬ï¼Œè¾“å…¥è‡ªå·±çš„å­¦å·å’Œå¯†ç ï¼Œç¨‹åºå°±ä¼šè‡ªåŠ¨ç­”é¢˜ï¼Œæœ€åç»“æœåº”è¯¥æ˜¯æ»¡åˆ†ï¼Œä»…æ­¤è®°å½•ä¸€ä¸‹å­¦ä¹ è¿‡ç¨‹ï¼Œä¸æ˜¯ä¸ºäº†ç­”é¢˜æ‰å†™çš„ï¼Œå®éªŒå®¤å®‰å…¨è¿˜æ˜¯è¦å¥½å¥½äº†è§£ä¸€ä¸‹çš„ğŸ˜„ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹

<!-- more -->

###### ä»£ç 

```python
# -*- codeing = utf-8 -*-
# @Time : 2020/10/24
# @Author : loadding...
# @File : lab_safety.py
# @Software : jupyter
 
from lxml import etree
import requests
from selenium import webdriver 
import re
    
def getQuestionBank():
#     url="http://aqks.neu.edu.cn/redir.php?catalog_id=6&cmd=dajuan_chakan&huihuabh=69338&mode=test"
    url="http://aqks.neu.edu.cn/"
    response=requests.get(url)
    page_source=response.text
    #print(page_source)
    tree=etree.HTML(page_source)
    arr=tree.xpath('//*[@class="shiti"]/strong')
    #print(arr)
    
def search_answer(answer_source,question):
    #åŒ¹é…åˆ¤æ–­é¢˜ç­”æ¡ˆ
    #s=question+'</strong>ï¼ˆåˆ†å€¼1.0ï¼‰<br/>ä½ æœªä½œç­”æ ‡å‡†ç­”æ¡ˆï¼š(.{2,4}?)</div>'

    #æŸ¥äº†å¥½ä¹…ï¼Œç»ˆäºçŸ¥é“ä¸ºä»€ä¹ˆæœ‰çš„ç­”æ¡ˆæœç´¢ä¸åˆ°äº†ï¼Œæ¯”å¦‚æŸäº›é—®é¢˜é‡Œå¸¦æœ‰?ï¼Œè€Œ?åœ¨æ­£åˆ™é‡Œæ˜¯æœ‰å«ä¹‰çš„ï¼Œéœ€è¦è½¬ä¹‰
    question=question.replace('?','\\?')
    question=question.replace('(','\\(')
    question=question.replace(')','\\)')
    #.*?éè´ªå©ªæ¨¡å¼åŒ¹é…ï¼ŒåŒ¹é…åˆ¤æ–­é¢˜ã€é€‰æ‹©é¢˜
    
    s=question+'.*?ä½ æœªä½œç­”æ ‡å‡†ç­”æ¡ˆï¼š(.{1,2}?)</div>'
    #s='ç¾åˆèµ·é˜¶æ®µæ˜¯æ‰‘æ•‘ç«ç¾()çš„é˜¶æ®µã€‚.*?ä½ æœªä½œç­”æ ‡å‡†ç­”æ¡ˆï¼š(.{1,2}?)</div>'
    #print(s)
    pattern=re.compile(s)
    #è·å–ç­”æ¡ˆ
    answer=re.findall(pattern,answer_source)
    #è¿”å›æœç´¢åˆ°çš„ç­”æ¡ˆåˆ—è¡¨ï¼Œæ³¨æ„å¯èƒ½ä¸ºç©ºåˆ—è¡¨
    #print(answer)
    return answer
    
if __name__=='__main__':
    
    while(1):
        #ç™»å½•ç½‘ç«™
        print("****************************æ¬¢è¿æ¥åˆ°å®éªŒå®¤å®‰å…¨è€ƒè¯•ç³»ç»Ÿï¼Œæœ¬ç¨‹åºæ˜¯è‡ªåŠ¨ç­”é¢˜è„šæœ¬ï¼Œç¥æ‚¨ç©çš„æ„‰å¿«ï¼ï¼ï¼*************************")
        username=input('è¯·è¾“å…¥å­¦å·ï¼š')
        password=input('è¯·è¾“å…¥å¯†ç ï¼š')
        #å®ä¾‹åŒ–å‡ºä¸€ä¸ªFirefoxæµè§ˆå™¨
        dr=webdriver.Chrome()
        dr.get("http://aqks.neu.edu.cn/")
        dr.find_element_by_id('u1').send_keys(username)
        dr.find_element_by_id('password').send_keys(password)
        #ç‚¹å‡»æäº¤ç™»å½•
        dr.find_element_by_xpath('//*[@id="web_login"]/div/form/div[3]/input').click()
        if dr.current_url=='http://aqks.neu.edu.cn/':
            print("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼è¯·é‡æ–°ç™»å½•ï¼ï¼ï¼")
        else:
            break
    
    #ç‚¹å‡»å¯¼èˆªæ å®‰å…¨è€ƒè¯•
    dr.find_element_by_xpath('/html/body/div[1]/div[2]/ul/li[3]/a').click()
    while(1):
        type=input('æ¨¡æ‹Ÿè€ƒè¯•/å¼€å§‹è€ƒè¯•ï¼ˆè¾“å…¥1æˆ–2ï¼‰ï¼š')
        if type=='1':
            #ç‚¹å‡»æ¨¡æ‹Ÿè€ƒè¯•
            dr.find_element_by_xpath('//*[@id="article"]/div[4]/div[2]/div/a[1]').click()
            break
        elif type=='2':
            #ç‚¹å‡»å¼€å§‹è€ƒè¯•
            dr.find_element_by_xpath('//*[@id="article"]/div[4]/div[2]/div/a[2]').click()
            break
        else:
            print("è¾“å…¥é”™è¯¯ï¼Œè¯·é‡è¾“ï¼ï¼ï¼")

    #æå–é—®é¢˜ï¼Œå®šä½çš„æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ä¸æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæ”¹ç”¨å…¶ä»–æ–¹æ³•
    #question=dr.find_element_by_class_name('shiti').text[2:-4]
    
    #è·å–ç­”æ¡ˆ
    url="http://aqks.neu.edu.cn/redir.php?catalog_id=6&cmd=dajuan_chakan&huihuabh=69338&mode=test"
    response=requests.get(url)
    response.encoding='gbk'#ç½‘é¡µæ˜¯gbkç¼–ç 
    answer_source=response.text
    #å»æ‰æ‰€æœ‰çš„ç©ºç™½ç¬¦ï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦å’Œç©ºæ ¼ã€åˆ¶è¡¨ç¬¦
    answer_source=re.sub('\s','',answer_source)
    #print(answer_source)
    #å…±æœ‰10é¡µï¼Œæ¯é¡µ10é¢˜
    page=0
    while(page<10):
        #è·å–å½“å‰é¡µé¢æºç ï¼ˆç­”é¢˜é¡µï¼‰
        page_source=dr.page_source
        tree=etree.HTML(page_source)
        question_list=tree.xpath('//h3')
        for i in range(10):
            question=question_list[i]
            #å› ä¸ºæœ€å¤§é¢˜å·æ˜¯100ï¼Œå†åŠ ä¸Šç¬¦å·ï¼Œæ‰€ä»¥ä»4å¼€å§‹æˆªå–
            question=question.xpath('string(.)')[4:]
            #æœ‰çš„é—®é¢˜ä¹Ÿä¼šå¸¦æœ‰ç©ºæ ¼ï¼Œå…ˆå¤„ç†æ‰
            question=re.sub('\s','',question)
            #æœç´¢ç­”æ¡ˆ
            answer=search_answer(answer_source,question)
            #print(answer)
            if(len(answer)==0):
                print("ç¬¬"+str(10*page+i+1)+"é¢˜æœªæœç´¢åˆ°ç­”æ¡ˆ!")
                print("é—®é¢˜æ˜¯ï¼š"+question)
                continue
            answer=answer[0]
            #æ‹¼æ¥æŒ‰é’®å…ƒç´ çš„id
            id='ti_'+str(10*page+i+1)
            if answer=='é”™è¯¯' or answer=='A':
                id=id+'_0'
            elif answer=='æ­£ç¡®' or answer=='B':
                id=id+'_1'
            elif answer=='C':
                id=id+'_2'
            elif answer=='D':
                id=id+'_3'
            else:
                print("æœç´¢ç­”æ¡ˆå¤±è´¥ï¼ï¼ï¼")
                continue
            dr.find_element_by_id(id).click()
        if page==0:
            #ç¬¬ä¸€é¡µæ—¶ï¼Œç‚¹å‡»ä¸‹ä¸€é¡µæ˜¯input[1],å…¶å®ƒé¡µé¢æ˜¯input[2]
            path='//*[@id="dati"]/div[11]/input[1]'
        else:
            path='//*[@id="dati"]/div[11]/input[2]'
        dr.find_element_by_xpath(path).click()
        page=page+1
    #ç­”é¢˜é¡µé¢å…±æœ‰10é¡µ
    for i in range(10):
        pass
```

###### ç»“æœ

ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä¼šè°ƒå‡ºchromeæµè§ˆå™¨ï¼Œå¯ä»¥çœ‹åˆ°ç¨‹åºè‡ªåŠ¨ç­”é¢˜è¿‡ç¨‹ï¼Œç­”é¢˜ç»“æŸä¼šè¯¢é—®æ˜¯å¦æäº¤éœ€è¦æ‰‹åŠ¨ç¡®å®šæäº¤ï¼Œå¦å¤–éœ€è¦ç”¨åˆ°ä¸€ä¸ªChromeæµè§ˆå™¨é©±åŠ¨ç¨‹åºéœ€è¦å’Œè‡ªå·±çš„chromeæµè§ˆå™¨ç‰ˆæœ¬åŒ¹é…ï¼Œ[ç‚¹æˆ‘ä¸‹è½½](http://chromedriver.storage.googleapis.com/index.html)ï¼Œä¸‹è½½åè¦é…ç½®ç¯å¢ƒå˜é‡æˆ–è€…ç›´æ¥æ”¾åˆ°å·²ç»åœ¨ç¯å¢ƒå˜é‡é‡Œçš„ç›®å½•ä¸­ã€‚å¦‚æœæ²¡æœ‰pythonç¯å¢ƒç”¨æˆ‘æ‰“åŒ…å¥½çš„exeç¨‹åºï¼Œ[ç‚¹å‡»ä¸‹è½½](/video/lab_safe.exe)ï¼Œä¸éœ€è¦pythonç¯å¢ƒå°±å¯è¿è¡Œï¼Œä¸è¿‡è¿˜æ˜¯éœ€è¦ä¸‹è½½ä¸Šé¢chromeæµè§ˆå™¨é©±åŠ¨ğŸ˜

ä¸‹é¢è¿™å¼ å›¾æ˜¯ç¨‹åºè‡ªåŠ¨ç­”é¢˜æäº¤åçš„ç»“æœï¼Œæ»¡åˆ†ã€‚ã€‚ã€‚å› ä¸ºå·²ç»ç­”è¿‡é¢˜äº†æ‰€ä»¥æ˜¯ç”¨æ¨¡æ‹Ÿè€ƒè¯•æµ‹è¯•çš„ğŸ™‚

![image-20201026145032142](%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%AE%89%E5%85%A8%E8%80%83%E8%AF%95%E7%B3%BB%E7%BB%9F%E8%87%AA%E5%8A%A8%E7%AD%94%E9%A2%98/image-20201026145032142.png)

ä¸‹é¢æ˜¯ç¨‹åºè‡ªåŠ¨ç­”é¢˜çš„è¿è¡Œè¿‡ç¨‹ï¼Œæ’å…¥è§†é¢‘çš„dplayeræ’ä»¶ä¹Ÿæ•´äº†å¥½ä¹…ä¸è¿‡è¿˜å¥½æˆåŠŸäº†ğŸ˜ï¼Œæµè§ˆå™¨æ’­æ”¾ä¸äº†MP4ï¼Œéœ€è¦ä½¿ç”¨æ ¼å¼å·¥å‚æŠŠmp4æ ¼å¼è§†é¢‘çš„ç¼–ç è½¬æ¢æˆH264ç¼–ç ã€‚ã€‚ã€‚

{% dplayer "url=/video/answer.mp4"  "autoplay=false" "pic=/video/cover.png" "preload=metadata" "hotkey=true" %} 

ä»…æ­¤è®°å½•ä¸€ä¸‹ï¼Œä»¥åå¦‚æœæœ‰å…¶ä»–ç±»ä¼¼çš„éœ€æ±‚å¯ä»¥å‚è€ƒä¸€ä¸‹ï¼Œæ¯”å¦‚ç½‘è¯¾ç­”é¢˜ï¼Ÿï¼ŸğŸ˜‚

